{"ast":null,"code":"import{useEffect,useRef}from\"react\";export function useOnDraw(onDraw){const canvasRef=useRef(null);const isDrawingRef=useRef(false);const prevPointRef=useRef(null);const mouseMoveListenerRef=useRef(null);const mouseUpListenerRef=useRef(null);function setCanvasRef(ref){canvasRef.current=ref;}function onCanvasMouseDown(){isDrawingRef.current=true;}useEffect(()=>{function computePointInCanvas(clientX,clientY){if(canvasRef.current){const boundingRect=canvasRef.current.getBoundingClientRect();return{x:clientX-boundingRect.left,y:clientY-boundingRect.top};}else{return null;}}function initMouseMoveListener(){const mouseMoveListener=e=>{if(isDrawingRef.current&&canvasRef.current){const point=computePointInCanvas(e.clientX,e.clientY);const ctx=canvasRef.current.getContext('2d');if(onDraw)onDraw(ctx,point,prevPointRef.current);prevPointRef.current=point;console.log(point);}};mouseMoveListenerRef.current=mouseMoveListener;window.addEventListener(\"mousemove\",mouseMoveListener);}function initMouseUpListener(){const listener=()=>{isDrawingRef.current=false;prevPointRef.current=null;};mouseUpListenerRef.current=listener;window.addEventListener(\"mouseup\",listener);}function cleanup(){if(mouseMoveListenerRef.current){window.removeEventListener(\"mousemove\",mouseMoveListenerRef.current);}if(mouseUpListenerRef.current){window.removeEventListener(\"mouseup\",mouseUpListenerRef.current);}}initMouseMoveListener();initMouseUpListener();return()=>cleanup();},[onDraw]);return{setCanvasRef,onCanvasMouseDown};};","map":{"version":3,"names":["useEffect","useRef","useOnDraw","onDraw","canvasRef","isDrawingRef","prevPointRef","mouseMoveListenerRef","mouseUpListenerRef","setCanvasRef","ref","current","onCanvasMouseDown","computePointInCanvas","clientX","clientY","boundingRect","getBoundingClientRect","x","left","y","top","initMouseMoveListener","mouseMoveListener","e","point","ctx","getContext","console","log","window","addEventListener","initMouseUpListener","listener","cleanup","removeEventListener"],"sources":["C:/Users/gonca/Documents/Curso/MDM/1o-Ano/DW/webdev-solo-project/webdev-solo-project-app/src/Component/Hooks.js"],"sourcesContent":["import { useEffect, useRef } from \"react\";\r\n\r\nexport function useOnDraw(onDraw) {\r\n\r\n    const canvasRef = useRef(null);\r\n    const isDrawingRef = useRef(false);\r\n    const prevPointRef = useRef(null);\r\n\r\n    const mouseMoveListenerRef = useRef(null);\r\n    const mouseUpListenerRef = useRef(null);\r\n\r\n    function setCanvasRef(ref) {\r\n        canvasRef.current = ref;\r\n    }\r\n\r\n    function onCanvasMouseDown() {\r\n        isDrawingRef.current = true;\r\n    }\r\n\r\n    useEffect(() => {\r\n        function computePointInCanvas(clientX, clientY) {\r\n            if (canvasRef.current) {\r\n                const boundingRect = canvasRef.current.getBoundingClientRect();\r\n                return {\r\n                    x: clientX - boundingRect.left,\r\n                    y: clientY - boundingRect.top\r\n                }\r\n            } else {\r\n                return null;\r\n            }\r\n\r\n        }\r\n        function initMouseMoveListener() {\r\n            const mouseMoveListener = (e) => {\r\n                if (isDrawingRef.current && canvasRef.current) {\r\n                    const point = computePointInCanvas(e.clientX, e.clientY);\r\n                    const ctx = canvasRef.current.getContext('2d');\r\n                    if (onDraw) onDraw(ctx, point, prevPointRef.current);\r\n                    prevPointRef.current = point;\r\n                    console.log(point);\r\n                }\r\n            }\r\n            mouseMoveListenerRef.current = mouseMoveListener;\r\n            window.addEventListener(\"mousemove\", mouseMoveListener);\r\n        }\r\n\r\n        function initMouseUpListener() {\r\n            const listener = () => {\r\n                isDrawingRef.current = false;\r\n                prevPointRef.current = null;\r\n            }\r\n            mouseUpListenerRef.current = listener;\r\n            window.addEventListener(\"mouseup\", listener);\r\n        }\r\n\r\n        function cleanup() {\r\n            if (mouseMoveListenerRef.current) {\r\n                window.removeEventListener(\"mousemove\", mouseMoveListenerRef.current);\r\n            }\r\n            if (mouseUpListenerRef.current) {\r\n                window.removeEventListener(\"mouseup\", mouseUpListenerRef.current);\r\n            }\r\n        }\r\n\r\n        initMouseMoveListener();\r\n        initMouseUpListener();\r\n        return () => cleanup();\r\n\r\n    }, [onDraw]);\r\n\r\n    return {\r\n        setCanvasRef,\r\n        onCanvasMouseDown\r\n    }\r\n\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}